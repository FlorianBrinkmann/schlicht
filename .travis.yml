language: php
php:
- '7.1'
addons:
  ssh_known_hosts:
  - "$STAGING_SERVER"
  - "$PRODUCTION_SERVER"
before_script:
- echo -e "Host $STAGING_SERVER\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
- echo -e "Host $PRODUCTION_SERVER\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
script:
- chmod +x ./scripts/deploy-production.sh
- chmod +x ./scripts/deploy-staging.sh
before_deploy:
- openssl aes-256-cbc -K $encrypted_557243a56511_key -iv $encrypted_557243a56511_iv
  -in deploy_rsa.enc -out /tmp/deploy_rsa -d
- eval "$(ssh-agent -s)"
- chmod 600 /tmp/deploy_rsa
- ssh-add /tmp/deploy_rsa
- npm install --silent
- npm install -g gulp-cli
- gulp production
- mkdir -p schlicht
- rsync -rav --exclude-from='.rsync-exclude' --delete-excluded ./ schlicht
- zip -r schlicht.zip schlicht/
- rm -rf schlicht
deploy:
- provider: releases
  skip_cleanup: true
  api_key:
    secure: q4HnsOAxs/otO6Yj/ziq+ofcSmnMELujrGIelzGZJr0trNq3jb3XR/opuChDKBy0Ldc7ZEg7OOSp+emXkOmIV04XvX4+5L5pEnQOkZ+g0+GGPGWyuMoL+aRNnuAQtQk/wLh6+vvfhHHET8E3C8+RvlZi94SNdFm7Z/aCcQgfyKKv1G44en/zZs0Qd8o3TfvS5wVknhZwPo/lzwdiDr5/0aEPJsZ23NbnVGwB7FOovpMy4OVCKyCZhEDLTqlfptkix1Chv2iz4kBzxoPYleOaKcoEAyaiGz/XlsZYnIPI9BT83bqjnbqfZY08ycE4hWUFUHF56XrYUr00ZGUb3GtwRtbpNqK6P6Qd+gw3VenWWZExgwNR3mceLmDNAeUNBkKezUmdiQiioerG/GzEuobWZhtSY3qv99YznbhfabdIoYi4LzCKzVRAw/ZzpMQ20qHAzPNdHII5nl1tBm3TWlQL5EpxrB+1nVixvKnOnC0bUMYEo52Gb+WcL2cNTpCe8jSzmbSWpAtgzQpRkVZSPmBNcvaiHziltzbija7nRvK9jmWh1H58p+Tlvq0I4fSSLeASQFj9VZAoD9qkkj7Nep0JvMZ7NzpGcjmY90JqkTElIW5K0tQbjUbHXIQgsnO/soiMxDbUJxJVUo+qNO7vOE6NA5vkEzoKjky2ttHbXW+jy/4=
  file: schlicht.zip
  on:
    repo: florianbrinkmann/schlicht
    tags: true
- provider: script
  skip_cleanup: true
  script: "./scripts/deploy-staging.sh"
  on:
    branch: master
- provider: script
  skip_cleanup: true
  script: "./scripts/deploy-production.sh"
  on:
    tags: true
env:
  global:
  - secure: sOlvLnVU/zn3h1Tf91mueC3Ezarrkx+zBpoFcgQ9cjZtgFhSKkIWhBXWHF2yg8IT1haCf0BRkFM4Pj0Dcky70ZbwRBK+WsV4XqhFAh9Hw4/hEjH+GpjSrW6rc3tcHythkE5bj47Jj7npRy1A/lzeBTWWnSI9NA2pUAERQ6TpAgMx8f3aIhxNbS12fPR3KPLhpuHiBpo3aJbkvHewkgZUsuMZ0tuMlKrAnGh18PtnVcguBD1qE9wVAJvbjiCJYxUpcQ4yrj59Wg5xM3Volj8tQaUfXgceNF61azfK7qmDQv0uxMad7k30X0sBekaAD49jiKSKpLme3EsBhDcp5Xcy68aX+61Ern8HxiVum2B4yoxQCg//aZtNIibih4QEOQQ+jQ+FzSb8GnlUWZMwvaaNBFxTHiTNb5Ult9P2HxuoHkXn7tKOVHCEiBNTGM6HQP7xNvvAaQOxoX8AVLNfvM5QRqCf/b6wMCbuvAao2YY+3tUMu1JJ1Hl/Pjpb5ae9duqQUtgutlChUVAjI03LgHfql3t4pXNA/pGzMieRlRpQVqyGJykWSVfr6PM+RXgoZ1KdEgHreGE4BzA4LeQ6PCPCnbm202eYls8wvRpjGr86mrl58pKzAHIeLoLp6Fo3UPHJnKLcA0+FXQBSjZCq5Oa+u3aji0HVlOZlXjBDYzH2IE8=
  - secure: cbWNEsco67IdjPplynSIpHw43M98Fxa4S+2l2+zmZCaRL1H6Zv04c2oorDG3lACYDmdN0yFu4RMEyjNCmhDgeDQ3sNwCeLGmcgVUFkCKqvGTfpZb6p0yvKz5bSYzmw+zF51H2G8sBp1IEpCMs5qasSKgyDhkRoguN8W//n5rCoQBwgAamQXEdONuuvAmfc4f4sv8GcuJRl2+VJk5DV3+qt3JLIyQ0FAl7S1+yop5dBx3ncJDoJoUko13pCSVaG0Bto0P5ea4a1b4lWgdUK8svdoxCY5x/3vI55hz8rzUto2bUVHmWFszslwsfIL6O+WWIqOdTIFcaslhSgSrKVyJymUdH8wA0hg+/770ofLdcShu3tkF8AGqeuINXEopcfTdvckzHM0KFlDs+dXuVPQkvuasQCKGKwK3PttEv81aeHG6YHIadNz0bo2Cfs/yuoI+g04SSb4Hq7hRz6IiAHT6ahms3jfvA+X0whIW2HPIRVLOr6ftkb4hclLGPY95kUUgrOOd5vS77RjUXtviYjtqMhoqwb70qaSy3ugfbCLoLgJWlsPhVzmoxsnFlU8/pTBSUs8oNGeW9LeChmqUsuihyYVRA1ckpfhIZizOHgMrAI6CcZdKwpHQi4nDhzwd+85Dc/4ZhaV4iPomhIsSZzRJlo4aM3qlFPf6yVuUd/UWTVU=
  - secure: OYqE4W4ZIqGovUcj8yXY2UubZJN4zbkOjT0p/nSuIBACSQptRYN+GNNZ78eKipf0xmw0XraD2nAcNltoKRdbzumEA2m4vXGFB+EdALtuswAXIeXv3LGw+1SWJkPMQstyn09xTq5IoZdHhxtfilyU916y3h+ms3E3Swf3+zzpD3lRTEuPWODyZz1Y4VZ7fIltDqLwPYw0KCFfXEXVRGP+7gj3TwUkInsEihrdeLr/IANnZEjuyMwJRfZkL3Yse/Cn+fOBXCKFcWwtiWGznT6EI0Rez5h9gAQN/+8I8x8wgOm5sADAP7B31igTCLGVQV3vr5xewT+Efz2KQovK/mIxd0bsmdHFI8RVE/W3fQf2/8sFh+SKDE7vsoUioKRuVROu4pAeLNFSENq5EGWcITsOKlahPDP8h9oBK+0JtO4QMxatE+KmNbXO9rZntsUbn6cft7ETqldUbkJ7P+cwJlBYWe1rsKrU9huXVusgx0jnyCC+usGQ4LBrvMVFXeSDBwZuxzHxF/HSLFNyMG1vuqKBMZ0frmvxr/5OUjD/MVBrUL6bOa35ot6eam72cO9xX0gNQfJNPdYlLZGEIMQg6K2N/DESBYxrYHcWngScHgfm1E50XC4+fPbxm+ATAKyDjy8jR9gauE4vCi2xLAz4kYl7Cx0bIUNR4uuh4+un77Kc7yc=
  - secure: jIYUd45HpkKUEj8LOR8tg0teaS4J1egcX4/AGhljOFJJPIgmq9yNpc1mtj30/OZOr67CBNXV8nK7z7cRmqFRHfms8SBET3nt0WyLkaEkgoVGuTotvNURyCOlZq+AN62+iBtlDJCNCS0pPPi31VijbqHCzpQP/UwVR0X4KQyjpZXJQPTRBSkCitgb/Z0sZgnce3cvD7thfx+KJ+j3ByH+LUTVWsTNgTUDJK10J8cnUrsiiwSSQzJ89NhJBJ8x8CvnnKAU+Pvp80YboqSVmCHm1/qwXSWPYFRNF2ZhNSCXciXxxX/fGGpwTEObEpLwM8p7KaO0KJnHFA7gop77emLkY8M3TAmMvLPIh/Lh4P2hyol2aCR9+qDxrXgE3RQdCnKYhG3O5agH30Jb595maVC9A6CDfKclHLJrlfk+VK9q7rhQcZo+YySCsq7zeoNccJyzZCh/USoQ1ig8HybK9RuuZ/hRu5QhL3PJXG++tZ1Vc3jc0A3HQMrxzKx7EI+e/gxPW4+27O3xYsdkusuRBH3TwsIGfZ11CjqhqCI50kPrSzu3Hgd09wP+V/aZO6bebEAL+atxffjuNzepbpX6lRsbiEsIOO8ovihboI/BTEr84hqeMVMu352ir3suLjrQ4xg4wrUYHEbMwrQoWXTI1GLKcW5EA04miAXja0f7aato7T0=
  - secure: Gc41OjhidM0+dtcBhTVQn+nxeBgSZLEDxOXxHpnPO4m6Hcx1DcBofvUyWk3mK8lZdpeAYMu2VpAn52N4sgEMnIVUkg/kB+65TlP+CspGy7QnbW5hh25uu+W352JlINI7ULiQ91Tfu/viUifmUj96sCFypdsfuwo+Fuefjicb8nVQNjoEtpDYGgxR+onfhcH3wIlc8WpB8NNMlYGOUK5k1rhlaJfJR3I4ihqpr482IxAmGoQ0ogjVEAtxKP10csxg5n+Q5gB37uzQqcmh+r74Dq0OgB2JPwv2z0YfHLtwUaNN9QxU/u2JsDykTzSmMlkoYyna0ZoRrM++5HvslvpCpT1xcyBTOu6R2VxgCXTCXbKzRLjyiSf8AyD7X0pbBEEfPxlG4GbRtDlccTVLqHAiz/XnXbcEVBdJtp/Ti7vJsAkAOtkbUT7oY7Veovjsmu3Ui2Z+BKA4/KkFiYPzVP7ef2pSj2v3URO75XnGuwbdG0zaI4AEg1fjAT2p+PC2FpACVVoSpt1CabtHKVoOKdb9Xuo1x75Ay/MlNTbIxXApKH3OgIbZjLOMn49iQyCc47Y1+0G4rR+zCsLwxFTDWYzSv93XO03iaztkeBsKbyldYDCBfwvbu2uQbs71FmlTAB2LG93AhQkLHudq1yKdSPG1ouukf8EUeaqlWd/Kf6vqYJk=
  - secure: Do/arKD0ExxJDqfjHbazL0vKsivg8AIXq4CRz/fTW8vAy/9NB9mlSgrJH3OAa5oWhBmPG6dTYq+8TlIzrOciszgv6knQacl0DbIjQIg6czdlhPVaZU1K5kQ7IKF/WDn5PS/LAPpCFeLMYAAWa2n1yOkRgnOh74220WPtHEPYYfyIENao8Xi7ugK03HzQDv50B1TaDvQoDi5SZabsz32BBjC6+O7IKUMV7QbTbPbXdqCyfvVbmIFmNS4UBhVnEv6flkMpKxbvS2E1raTa3wuH1M2pU53BEfRNtpzsG85rHZXUwDh/sJE6eYWmqLVJkD9ZxU0N4ax9nftqCohkxXQxiw45CqMe7Cqkn9tTjqKkfWh5e3Zn7Iecd+7gA7IAnYFjJB6qNaNmJroX9DiaxD6b6c60kPTb4DlBvFmHU0bNNMsb+kU+t7th4Rr0Tmu/S/sebX0YkkNM/PRlHfM/wP0fshQD8OzsqyqrWo1M3V9PsCVmOI30jT6EID6k0ccS5Sbgw1oblttWNr9SZNQEGgoPw7IP2GBOFpCN5/UqYTNbhKdnBuFgyGrepFWfJyWSbYxrnELZjYJzolzNmOxBh0i+NuT2SEAkwDaV/mm+8qUcaM2VRdpw9c22Wt3Q2H1dmWhn3RxtrdvsgtuWhR0zYP7P85abweQ/KTzA316XV/xQWCQ=
  - secure: 1Kf9+2DOOccQoZwQzS3JwbtkFrB24a04lQEf2n8moYfSTL4Z6Dqbm7NBBF5dbB7JoHWcbSkCH+6fieNCon1DHXLlW/M+EcMQN7zDD38uREkK2Sggr+YHFTIaaoxlKVI9WgK1nh08qkd2tcMWd308F8CVWXYEFgq/kFh2F4b9PYqOxabyHM7lQcwX2sG834pmvihdgFcbUWM19dbBf+BT3qrjDESLYVtywKQUP4bMmEDgqPfSsDXwfTpXhkK2qzTALtKV9NFVztQzCJmY1O28ITP7X5r5XVzUt9GSm3r0YKJ90QXUm03rQKNlSc30vOKi2FiyS/IYgmzCk1Hhb4i8Q3v+9+Ldk8WG08IFhUC2dMvLRBrtaQBGHQC4cV6vCtzMO6rwlEzVAxq+QM0WXjjexuoMdqZTkEGKv2xOhRn5B5exNewMLpuqBmq4GZuQLZz+Gf9XnC+jpvfVKF16XNvSCMb+bEWOYcFB6bgVzrszUC+94rw5PKbqcY/YOE8i0xGl/V+urz2ovNTZn1PJfGaqHxEGMhZ++dmNDfSIdBk7MByEy2zsVMSNaGHlBtHPXkexxNHKeW6mkITirlgqv0Y7peMJqMS3AFQQGvQC109UFO4vM9/nD8hSf7ZXxlqjjI3Yl6cbvsWjZxpdcIDU8Z9BzdNbRXGoVXNNn8ChSVev2uI=
  - secure: ziVzMeRoj/xiIZ56tNJV86bvx949ISayMW1icJ87EuO21jc81BN7gPxb6BaJUOsUKQ/Sq4wVlXyq/jfbt+NGgvNYzKvp0WG5U841p9p/40tPHWpbSDT6ClZ/njbufDm+pvZ7ZWX8/bY944lklL17lEEuRTvd+oSPhIyiS2gj5qCu0gxfogCJB8NV1NV8vp3mXsAJ3PYCQKYRrBUMJlfOFV1m+4imuQdUmMC+HVOHCsKmAJr3NjXTs4a8YB0v0/IBoCajO4AuU7+15YQ3+ymidJdicSncsCouq2P4n31dEwpawPb7TjJyZIj/TThpmTsGC3iZ3d+B+La4JhyUyqCkyUZIebJSmRzEIYTWd1ktZFSNBbEg1w1VYiNoz4/+QT8iTzd3FaogdVoYYUibiqekzfhMPhtm+VNDMoRJHO4AyfipOE3tLAYgTGQsAbaCP7CbTg/BV/c54atLwLQ7sPy2in/Gh/k8bwk9YVpNbhThG0IcmRcWIxsUYOlg5qrgOaVPa7yiK0ZJteP2W4rrqYZuyDBNLgE+JQ4UwBEzcJ7hZHxDgEamL+7YN0AFdxVoqh+IX/aYzPEPveDGG+AniTTT4XhP3RjoBvVBpVimkXRdgkYdATg7gyOb68fgstKhmx6o0yu0Uzql/ECsM0BARNU3v01sNvv2ty7RXTAwdrxjmLA=
  - secure: CxK4BUCyNZcixW3lJPfFN45eZiTXXGHAWQmAmPD1Z3pMUsrksiRyNyJHXb7uAqUeH/u8HxiIilIA1NHI9lh/IRXHPIiR+AVSvxaQYZlFCXFUbAAzcfGV+FzxpQ3fPvsNk1q1tMYWfoSV2HGGrPyNj1BD8v5qowfpBxUxUJxhJirRtVAp/6iiSNOM8FB4eJx+2u08lOQ4pPvQKg3dPcABZBzoTcJpzVkPqmHnWYfd1BwCKy66z0FNlCURQw9WWDuxPR87pq9FVLG7zwQYMqoI/lseWd8rz/U/TcG77hGBD4JoTbzuBYtB0xQMbBaF2hhKdpHo5JIw1Tr/nTSRrN5IqpetBK6Sw43m8V3Pw7vn6HW/vsTvNp40qb37wJ9OSfR8N5GdrjqEIci3/dUgRqtmcXV1le4y3hRIh/DhduN9g/JSMP/9Hr+r7vw/tzgnDIbCTpVWhqN161vtxEAG6fl89v55TTNc55c6acW+KXVaa8RtdSZaJYe5gN/2diydc+glTPNajCGH6hRSTnY5CcoGljuXWGxNjuBhfnsExTOt0vIGxQwZ5rPZg/aAOuJkVns94pzqDPdm0RY1iI6ShuyDQbv8ZKAoIKvxCKu2/nZythU4fpRc+KBD2ajx+qmTDTFlMCCXBqLSWKxekZS7y/dOlCD7rtXxN93jEHl3FzFyUFg=
