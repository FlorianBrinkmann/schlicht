language: php
php:
- '7.1'
addons:
  ssh_known_hosts:
  - "$STAGING_SERVER"
  - "$PRODUCTION_SERVER"
before_script:
- echo -e "Host $STAGING_SERVER\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
- echo -e "Host $PRODUCTION_SERVER\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
script:
- chmod +x ./scripts/deploy-production.sh
- chmod +x ./scripts/deploy-staging.sh
before_deploy:
- openssl aes-256-cbc -K $encrypted_557243a56511_key -iv $encrypted_557243a56511_iv
  -in deploy_rsa.enc -out /tmp/deploy_rsa -d
- eval "$(ssh-agent -s)"
- chmod 600 /tmp/deploy_rsa
- ssh-add /tmp/deploy_rsa
- npm install --silent
- npm install -g gulp-cli
- gulp production
- mkdir -p schlicht
- rsync -rav --exclude-from='.rsync-exclude' --delete-excluded ./ schlicht
- zip -r schlicht.zip schlicht/
- rm -rf schlicht
deploy:
- provider: releases
  skip_cleanup: true
  api_key:
    secure: q4HnsOAxs/otO6Yj/ziq+ofcSmnMELujrGIelzGZJr0trNq3jb3XR/opuChDKBy0Ldc7ZEg7OOSp+emXkOmIV04XvX4+5L5pEnQOkZ+g0+GGPGWyuMoL+aRNnuAQtQk/wLh6+vvfhHHET8E3C8+RvlZi94SNdFm7Z/aCcQgfyKKv1G44en/zZs0Qd8o3TfvS5wVknhZwPo/lzwdiDr5/0aEPJsZ23NbnVGwB7FOovpMy4OVCKyCZhEDLTqlfptkix1Chv2iz4kBzxoPYleOaKcoEAyaiGz/XlsZYnIPI9BT83bqjnbqfZY08ycE4hWUFUHF56XrYUr00ZGUb3GtwRtbpNqK6P6Qd+gw3VenWWZExgwNR3mceLmDNAeUNBkKezUmdiQiioerG/GzEuobWZhtSY3qv99YznbhfabdIoYi4LzCKzVRAw/ZzpMQ20qHAzPNdHII5nl1tBm3TWlQL5EpxrB+1nVixvKnOnC0bUMYEo52Gb+WcL2cNTpCe8jSzmbSWpAtgzQpRkVZSPmBNcvaiHziltzbija7nRvK9jmWh1H58p+Tlvq0I4fSSLeASQFj9VZAoD9qkkj7Nep0JvMZ7NzpGcjmY90JqkTElIW5K0tQbjUbHXIQgsnO/soiMxDbUJxJVUo+qNO7vOE6NA5vkEzoKjky2ttHbXW+jy/4=
  file: schlicht.zip
  on:
    repo: florianbrinkmann/schlicht
    tags: true
- provider: script
  skip_cleanup: true
  script: "./scripts/deploy-staging.sh"
  on:
    branch: master
- provider: script
  skip_cleanup: true
  script: "./scripts/deploy-production.sh"
  on:
    tags: true
env:
  global:
  - secure: 1QZsiBx7a+wkRt/wgocAc0I8JNCkqMnldpnp3dtJrsWLAE22YXaX4pZ6AiyszHXsJ+x83Mq0l9x4gp7q8myYtWfJPA/2/BL1lCJsf2IZCDxw4MkypoC4iLHUyUpKy6LCgFQHHvek96xpSQdMMqKXDd5iwjfkdDWnYFpNV5MuUG3yEtLFUbTmoL+vUl/oplAOsz9dYRRMs+Cbo67fWTvuVlOGz0uhvfz+5AMPfx0g/saIfjQV9mTbF4CiyAZq9tYfEL3oFymgPKXc80ffQ5qtHEe0B/FiUVzpdG946AfpFdxXeei4PU0OhOW5qFzbacIi92sBpR9qCVMDtdt0yKtQZgq402y0T4Rex83OJ9rx/z26HlLs7uJROnxU6thoLdOOysjwS/PmM7K8d3+IpFr1w462ALi+2UQ6QgestFAPMAHxtUg6wXiczI2V8awthykmW/53EKcF9pz0hi66iwUNoOj8kIioJkTybhNHcxzIluW/+geEwGeSYPn1vrIgGaJDA4ljIrzA7VVfpEa8BYt863dM7cUK9eU5u+pS7riKHh7HluH93KQ8NHejVk2ucW1fVrk8Zzflf/YO/3P8kmnuVE9pM4tA+0hGPlxkCbaYSKdo9+4d6GYEmlXc+snbDXzLgIzNAJV00tV1WBZkipdn/PnsAbwzH+930D8IcPxq904=
  - secure: T4wK+hJdxbKSsjDWDD0ObTm/GoiJPDhp/xgpPIUGmPHvjKHfaA++sLrd6eHjDSOTeFjIMVyGs3S7OXX/tTNE7IXnRKPw+Dv4oCorAyofcMOSdcKMg94bGqO4DdZH/wLhCosth/nyc+K4J7Z5bwWAYmWjJucz25eGVJihtaM0O12fuac5JRT3c1VrARY9m1A/V4SQPe2R6HWO9LGIcKzeLRSPAGn2ksfETkwwnuE58T10OltlZYDDKLWNv/4uuAqxySQnN5d2bHu3TGVJ5yLWDQvyfrTH9hlKmC02GzUvZQ79vacxrYrPCjo8QVZ7Ao4ZmdF5C2epUQd9poB94Ak38fH/TcknBCawfQ2YHjhksl8id/Bsr1FYGpr/BMeqOpX10lR19vAqW+y0Mgx8w0SudX0hksh5XoCE0u9ukVIqPSuDRMWBeE4i9M+KjNMo2qlqlh4P+nwMN6GFje0bnF4RBWzm3GumC6cw5DcMGPVopCd7DPG8STFLvx0rmgx+/vQpAcA6o4KDHZ6Q6/MqwD76hi+7RBErcolQK6oY3jX8JnTxTLFxBJElH86mpd+0B4Vyv6LIG3qeB3Tnv4DrDEJDy2O5haBLcl2k0uLvVZNczeK/2fNCLJLIZDcC+Ghy/Dj24n4ziDolsHZmqTLDUVejOKZ/YWs1coXbk4udX6ThAwA=
  - secure: AkFEsxqOr5smb8/nfS4c2ABy656RrGHG/1UheIH1Eelyicp/Q5ONd5om/c7vxsCOveRvNw1UMxoGeKQo1tQ9KdMmyu6bMqUNG3yu1zr2hMBfGrgP5/2jY4VCpAmcjCzpZNQFJ0F8v8/Grgt3l0/QaDxFSVtAB+MUpkNsXLOtJs9WJ9g0Nhkpy8h6U/ANLtf+rqTlqRIqFRz3aTtwjvRQyNhj8blpcA4k5O9UPQGSOIB06XCkmbGYeHGdmQvOESVdVDsPhZj2pgO4gg7ZZagsvWGm18lzCFgyIOgoKVfSb9y1FanxmxCKUhRPHWRIiezOB8D3ZE8RRnHrE0hl5lEEexPZp62K8PZv/4co1wuGuMHcBMuN1ycQmBbxy7eTIpS6Yh2RWV5OkiJ5MMa1C3S+YwFRechbLcX8eebUhlk79KRPbN0P8iRMfowolKEwAX5fz/VK+H5wb3zIrcO9xtQFW4vIpv008of95g+KB5n06CNDESVYfgua/kS08AFaEc5NG0TaVeuNAts26uCiBhu1iJ2IjOtlu3HYiqSnk9KZn8Xk27jj2fqcPfYvUD+3P1GkkuN26STI0+nAzOgUygd1NwWwVYXYue6A4nHpN7dMbSCWHwalYDwURvmpBBJtlhlaS4EWq8f5oPuBYIgSQjyL7kBGyTDIk0ix7gHcLTqn4QQ=
  - secure: cb2Sko6lyHtLohvdNVx8nDnYLNSgkYFX+NTGMkurmJGS/2htlzTYA5DvORrK0NvtGtSO5yhTo0GTwf/C4oq1RRQTdbcMPLW2uwP7UU3y7GLBAhAF7r7Z1wtk3XIS7ptzUD/tXzHbqZ4+h3ch0Zyp7mYI01yXvApQ2OflgJlAvVIJpXkGITXLZCpNj8D3gStsnHK98hwHrDCnsKZAyHUDHkY1YA9L0TGfCNNYIw7+Lmi5sM9k0ZywfsKhUKTHJKDIbF0mYKFThkhMqeRdviGxMZF/mU4eoG4eYSEKt30Ep2/+a3/VVsIchJ9vNOJvUjVcIm6d2/nBysyevVTbjCMClQTLTY0QD3gyqME8Zi7etRSXmaxyM6YiRkSL3uZQPgmKgCF/eZTT+m7kUUtov2Z8Bvu00k/cCrO8e/wfj25QjTBWoQAn50JjIwljUqSLH4PhbZ+sXN7Jfvk3oISBUv58hi281QlHhcHaUorWhw3Wy8plOYOH2MGD5OaOkyyRO00+r8XYYcd660LqPxer3lkigp1oQA/xOr/Yn3r061cvgKWNFH87Ae/apanWWLEUPtko5IjgQVbm4XtVyTyQzpC58ay5jesxBRe/mNhhH0aRktKCz5t0pqBVUtjzSxNXMitS/oNePR/bVA3J+/dB+lcdX6OPFZKlWysw/W9NIBK9r9M=
  - secure: 0SpT3HJEMEFjtH66ZjXObpjQqLiIqSE8WSerKG7BNbklnNOROz3va+5E0kovnurnfEoSoG8yNsAJlyOg5Ga2EGrwrfIj3hhK3j1x3VSsW4D+4zQKlhHkjfQRt7tEIjdDYuxrCVtRu8nfVOjCjIjFRlrRwLntAGjYXscF05KpVpWoWbm7pG/5+aMSzeCEQSPduvwIMQdybhqp6CA6tBuLsYttvM7Zx+SOCppkJya8DWX9bsX0b36OsjZHRr/qq1AMD4NBGH6SbuP7p26MUtOgrc71HKaoshhF9OMew6aC59kkY2AW5EkrlYPfCx1NTJyMxTLbtKrTmzzaxTNWWkXpVVyyglVFpLhfRz1wReg6ZmnE8446LKrrEIIbcAaSmVq+5sLXnKpZfbC1abMqS9Aa/kjV65L3osC0irM1fa6I+kXWoGFlzZasVYtIUkDJLOx99Yr3DLsEXKoBf6+Xi1fwFdFWnyRBoS1flg4Cx6BYlMP8uFLfHc1Xu6A34knLZwsG10SPdN6NaG+DdTn0924Wb42AVZXd1bzDXRgNEX7Up0nTzhw8bM+gIzh0VpQbtirBIRPqADBwFdF8BELkgT4uznWmxrkagkyA9hLWLys1wjmFe8YgQQMHYG8b8tzSIFIwPN5KwgT80ScwBc47iOgBMm/RVOIluDwJpuxhVsjTMhQ=
  - secure: IMpDVO2lkLQjpRKfpM8pgaItb/87jcwwoBduTXVECqj9VqWKNGRDTZbWhrGFD5YA5zrk9tl9YnhEasxpvUpIwkIMDY1UzbaWYFW35Kpc+DtX2JB/ii9sFJM7ZnB+FjtY4p0VzpPlOcXDg3CsTPgACesFP+bbErCqwy7KqsONB++nI9+7154tf6RQXVVOYCMSrtiSDXoFhr7L7FnFrAZTZ7j2eGKeENo4qmzdc/96Krxf/rsdfFg3WJGUaoymIYhN1deOsiXEtWJV30wyILuf+IBS99t1d0tAUDRhmaFvc+gJtUKYv0JsdoMxR+E5jbU/Hm20SdQKlKyuo3h6N+904DvqKqZwjZn14cXSW6tHb/E4k+OCywyj8PacxwGWL+K3FR3df4JtqWXxBEXdQQsP/D8rePEU5mONaQ+R7KyFO1/lrFs8Xfx5RWmUUY5cklYYl8WnWpW67TWW3fmm7oeJSIqjlER0gl6Mx/k38R3za1Nj0WthgZWYiyVRj35QXKMOSXnflVFAdcvUCHOiR3UgwQ6nIHwFX1aGQAPqTeqJ/TZ9ANZ6NIAPW52dWf+2UyFSxEvQt32pbGEzk09PlRB7QxP8m9PU+EGSNB2VKFu3qWq9s7FJppta9sUmXhuCvDgJfBaDcvQusr0lkizMlRmHKIu17m5JZvlJ+u7iAmRMyoM=
  - secure: gexyjINkb31INaEOMJPbqnGmklL1uCZ81e9/8ixptSwVKk/QFyd+Rur3NrXBE9kV/VRObEIJDYC4G8JZqN2CYOXQghJlDkjfziqxVazMx1/vuLFhXs+RU+m4hUbiUcw2YXmTZ5eqyYd4BdePHlnKT6TG0WwG7sSFu7tTLgu2YdP30pu851/5ktcLRYgp+o6DHWeLkrOsG3B//x5jJm9u64/iD7ZsrJDL6xgBnmTtARUhMBtZUAWCuz0JB1V9TNC42FIOIi1Bz5N/AmZdht5QQiZIHNOVOTYF31FnPzfq/Mxy1HQhDH/eYpFNUfChIb4uXRQO0vE9QplHlMQbD3/8tGnJj3j/ydzjz/0zv/2FV62i3mWUiFgg/uPLSY2v/+gyLBXPXM8YpBGVRVAvsqF9z0t/79tw+S2bZkXstmAfxbvj9tSHtRvcRpN3lXRntjGrKQnv9gIzBLzFRWiLP0xTLUMEH9zPnc4dIhxn7FEnuHTGwxwTKoRQ61/+QHiWehcnugX51+JkR5u9Y0PY0FtwR5jSn7UsLAlHXj9vH3sPejy9wvMLdy1DVRAC104j8aCVnn+xS7mzBqzkua/zY772yaeiGXwcWDnUqr2xLGKDYL8JLohTi42ElHFXAz8O9BFK0Jnc65FeASyc72Om4oOU5ZaUVbNfep7Wv7EbS0mx/KE=
  - secure: rLWk3yNH/kzUNNUQhpzQ+wk9PtAhG3uMBSx4NNF4JRRkYNn9HPZXwumyHX3fLE/W5sscF4fy2gRBJmkpj+T4oaO1FetlPt/QCUYXDzT3T3yzfK4n9zQUY4mMevZJ9FJE3ITUj2a8RNxrDZ4/uHHjg/uilID3LWsr3m6gcFnbNQfGB5Dd7HMi5Uy/nuikW4cRfdHuZUU9G5C/jsC/RhSIFPSMSw47g7R+au6Sm4PjL85ECP0zHuHzbrAatWzCe0fvWrA9a8bWd4z4620YTKdCBlreWKb+R5PYkTlVRyDVXFG7NpSRB/0zTDC/dnwLF+oDt1IGlYdA9jBFnZVw2Wu9y3FCSPLZuMXw0h+EpUwF7THbn3JJmLfXMbOcpMa7LT5lbPPklQbUZieErS+4FMJe5L2TYjcd9zRP8i3kXhQKlOcHcMB/6hTIxI0NHAo/CgBn0UEfD9AAAXai8naUWIBbM3FpRJI0wGxAFB7Gr06/rFslUcyNCCYPzClC6wp2zCcIr5P7F7xGWreoNuH5T4STgAQkc0i9QFyKbQaUHSPO8WvugdALWRc1+an1q/YmtopyRIQsuAwMg0DBFEmTKHUQhIHyzjMoIyGIcVV+rsOO46ht8MDXTdDjFdPdviNTjAc6irY1a4PgQ8bvXEaAFEmhT3JE5xd6VmDBgjBpiqGlMDQ=
  - secure: u0I5jD+QqC//XBga4BXt/dy7VIMan4c/xxa2jTn7lZtokHFDs1YhZF41d3K8vx+9BjR8sSV383nIEtkFkUMWdGWR8Jm+mNQ/zQE/2Kh56PzbkJMEgpFacMFbXXANlaN5EGhRYz2Anx6/3AGVQwa9aB5Hta5zJ6CxAlFCkUutXb88fEsTkuJJiLEqyXaMzkDOg2ej21h9IvgUGk6AeqI+m6QJUxjs2oDmNQrMJFRhOX25JyKmsuLYyDzTmKelrHDoQdr+b/Pl/10f6SzIgGg9S7qksY6NN16Y5xv54UlXiQTkfAi8TAitZvkZhy14FeaHpDS5j2LTne9u30Zm5jc9n9nlt7Jy74dkfiQvVJpFexfrld3BirkPUgXFXd1AMxrKILcdXI8O7RAADBQO96zSnncFEODs4YCh/xW33/nycpPlr7J+SwCOP8KzA0QcgW11XMOkc9iF0W25arSxbxOjPAampobtE2FPgp38+ZfFNXSQ18/PZCckfCfsP15ja4wHBPdUvhrPm++Vbf2JXTVLKG5zWL8uRQfdjBdGiPtTFnrQYzrpQVYwEP7wZ4Ebl1Chwa+a88vazGkWEaVstmqWgCd0XUIRBnZgoQ5jsUyOkN1ON2mbZHsoJ7RUN9Mz8QsZpmI1vGpgeK8QtH5e0RU+ZCS8+OZsVhtaFlCqY7tvVXo=
